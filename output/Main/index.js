// Generated by purs version 0.11.7
"use strict";
var Control_Applicative = require("../Control.Applicative");
var Control_Apply = require("../Control.Apply");
var Control_Bind = require("../Control.Bind");
var Control_Monad_Eff = require("../Control.Monad.Eff");
var Control_Monad_Eff_Console = require("../Control.Monad.Eff.Console");
var Control_Plus = require("../Control.Plus");
var DOM = require("../DOM");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra");
var Data_Lens = require("../Data.Lens");
var Data_Maybe = require("../Data.Maybe");
var Data_Ord = require("../Data.Ord");
var Data_Ring = require("../Data.Ring");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Semiring = require("../Data.Semiring");
var Data_Show = require("../Data.Show");
var Data_String = require("../Data.String");
var Data_Unit = require("../Data.Unit");
var FRP = require("../FRP");
var FRP_Behavior = require("../FRP.Behavior");
var FRP_Behavior_Keyboard = require("../FRP.Behavior.Keyboard");
var FRP_Event = require("../FRP.Event");
var FRP_Event_Time = require("../FRP.Event.Time");
var Neon_Class_HasRemainder = require("../Neon.Class.HasRemainder");
var Neon_Operator = require("../Neon.Operator");
var Prelude = require("../Prelude");
var PrestoDOM_Core = require("../PrestoDOM.Core");
var PrestoDOM_Elements = require("../PrestoDOM.Elements");
var PrestoDOM_Events = require("../PrestoDOM.Events");
var PrestoDOM_Properties = require("../PrestoDOM.Properties");
var PrestoDOM_Types = require("../PrestoDOM.Types");
var PrestoDOM_Types_DomAttributes = require("../PrestoDOM.Types.DomAttributes");
var PrestoDOM_Util = require("../PrestoDOM.Util");
var view = function (action) {
    return function (state) {
        return PrestoDOM_Elements.relativeLayout([ PrestoDOM_Properties.height(PrestoDOM_Types_DomAttributes.Match_Parent.value), PrestoDOM_Properties.width(PrestoDOM_Types_DomAttributes.Match_Parent.value), PrestoDOM_Properties.background("#323232"), PrestoDOM_Properties.gravity("center"), PrestoDOM_Properties.name("rootNode") ])([ PrestoDOM_Elements.relativeLayout([ PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(600)), PrestoDOM_Properties.width(new PrestoDOM_Types_DomAttributes.V(600)), PrestoDOM_Properties.background("gray"), PrestoDOM_Properties.orientation("vertical"), PrestoDOM_Properties.margin("320,20,20,20"), PrestoDOM_Properties.gravity("center") ])([ PrestoDOM_Elements.linearLayout([  ])([ PrestoDOM_Elements.imageView([ PrestoDOM_Properties.id_("loon1"), PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.width(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.margin("-200," + (Data_Show.show(Data_Show.showInt)(state.l1 - 300 | 0) + ",0,0")), PrestoDOM_Properties.imageUrl("parachute") ]) ]), PrestoDOM_Elements.linearLayout([  ])([ PrestoDOM_Elements.imageView([ PrestoDOM_Properties.id_("loon2"), PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.width(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.margin("-100," + (Data_Show.show(Data_Show.showInt)(state.l2 - 300 | 0) + ",0,0")), PrestoDOM_Properties.imageUrl("parachute") ]) ]), PrestoDOM_Elements.linearLayout([  ])([ PrestoDOM_Elements.imageView([ PrestoDOM_Properties.id_("loon3"), PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.width(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.margin("0," + (Data_Show.show(Data_Show.showInt)(state.l3 - 300 | 0) + ",0,0")), PrestoDOM_Properties.imageUrl("parachute") ]) ]), PrestoDOM_Elements.linearLayout([  ])([ PrestoDOM_Elements.imageView([ PrestoDOM_Properties.id_("loon4"), PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.width(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.margin("200," + (Data_Show.show(Data_Show.showInt)(state.l4 - 300 | 0) + ",0,0")), PrestoDOM_Properties.imageUrl("parachute") ]) ]), PrestoDOM_Elements.linearLayout([  ])([ PrestoDOM_Elements.imageView([ PrestoDOM_Properties.id_("loon5"), PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.width(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.margin("100," + (Data_Show.show(Data_Show.showInt)(state.l5 - 300 | 0) + ",0,0")), PrestoDOM_Properties.imageUrl("parachute") ]) ]) ]), PrestoDOM_Elements.linearLayout([ PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(150)), PrestoDOM_Properties.width(PrestoDOM_Types_DomAttributes.Match_Parent.value), PrestoDOM_Properties.orientation("vertical"), PrestoDOM_Properties.margin("20,20,20,20"), PrestoDOM_Properties.gravity("center") ])([ PrestoDOM_Elements.linearLayout([  ])([ PrestoDOM_Elements.imageView([ PrestoDOM_Properties.id_("destroyer1"), PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.width(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.margin(Data_Show.show(Data_Show.showInt)(state.xBomb + 565 | 0) + ("," + (Data_Show.show(Data_Show.showInt)(state.y + 600 | 0) + ",100,20"))), PrestoDOM_Properties.imageUrl("boom") ]) ]) ]), PrestoDOM_Elements.linearLayout([  ])([ PrestoDOM_Elements.imageView([ PrestoDOM_Properties.id_("destroyer"), PrestoDOM_Properties.height(new PrestoDOM_Types_DomAttributes.V(50)), PrestoDOM_Properties.width(new PrestoDOM_Types_DomAttributes.V(20)), PrestoDOM_Properties.margin(Data_Show.show(Data_Show.showInt)(state.x + 600 | 0) + ",570,100,20"), PrestoDOM_Properties.imageUrl("bomb") ]) ]) ]);
    };
};
var crossPath = function (left) {
    return function (right) {
        return function (boom) {
            return function (oldState) {
                var $12 = oldState.tar && oldState.y < (-600 | 0);
                if ($12) {
                    var $13 = {};
                    for (var $14 in oldState) {
                        if ({}.hasOwnProperty.call(oldState, $14)) {
                            $13[$14] = oldState[$14];
                        };
                    };
                    $13.xBomb = oldState.x;
                    $13.y = -50 | 0;
                    $13.tar = false;
                    return $13;
                };
                return oldState;
            };
        };
    };
};
var incRoc = function (left) {
    return function (right) {
        return function (boom) {
            return function (oldState) {
                return crossPath(left)(right)(boom)((function () {
                    if (boom) {
                        var $17 = {};
                        for (var $18 in oldState) {
                            if ({}.hasOwnProperty.call(oldState, $18)) {
                                $17[$18] = oldState[$18];
                            };
                        };
                        $17.y = oldState.y - 15 | 0;
                        return $17;
                    };
                    var $20 = left && oldState.xBomb > (-300 | 0);
                    if ($20) {
                        var $21 = {};
                        for (var $22 in oldState) {
                            if ({}.hasOwnProperty.call(oldState, $22)) {
                                $21[$22] = oldState[$22];
                            };
                        };
                        $21.xBomb = oldState.xBomb - 10 | 0;
                        return $21;
                    };
                    var $24 = right && oldState.xBomb < 300;
                    if ($24) {
                        var $25 = {};
                        for (var $26 in oldState) {
                            if ({}.hasOwnProperty.call(oldState, $26)) {
                                $25[$26] = oldState[$26];
                            };
                        };
                        $25.xBomb = oldState.xBomb + 10 | 0;
                        return $25;
                    };
                    return oldState;
                })());
            };
        };
    };
};
var fire = function (left) {
    return function (right) {
        return function (boom) {
            return function (oldState) {
                return incRoc(left)(right)(oldState.tar)((function () {
                    if (boom) {
                        var $29 = {};
                        for (var $30 in oldState) {
                            if ({}.hasOwnProperty.call(oldState, $30)) {
                                $29[$30] = oldState[$30];
                            };
                        };
                        $29.tar = true;
                        return $29;
                    };
                    return oldState;
                })());
            };
        };
    };
};
var loons = function (left) {
    return function (right) {
        return function (boom) {
            return function (oldState) {
                return fire(left)(right)(boom)((function () {
                    var $32 = left && oldState.x > (-300 | 0);
                    if ($32) {
                        var $33 = {};
                        for (var $34 in oldState) {
                            if ({}.hasOwnProperty.call(oldState, $34)) {
                                $33[$34] = oldState[$34];
                            };
                        };
                        $33.x = oldState.x - 10 | 0;
                        return $33;
                    };
                    var $36 = right && oldState.x < 300;
                    if ($36) {
                        var $37 = {};
                        for (var $38 in oldState) {
                            if ({}.hasOwnProperty.call(oldState, $38)) {
                                $37[$38] = oldState[$38];
                            };
                        };
                        $37.x = oldState.x + 10 | 0;
                        return $37;
                    };
                    return oldState;
                })());
            };
        };
    };
};
var main = (function () {
    var movement = function (left) {
        return function (right) {
            return function (boom) {
                return function (oldState) {
                    return loons(left)(right)(boom)((function () {
                        var $40 = {};
                        for (var $41 in oldState) {
                            if ({}.hasOwnProperty.call(oldState, $41)) {
                                $40[$41] = oldState[$41];
                            };
                        };
                        $40.l1 = Neon_Operator._remainder(Neon_Class_HasRemainder.intHasRemainder)(oldState.l1 + 2 | 0)(550);
                        $40.l2 = Neon_Operator._remainder(Neon_Class_HasRemainder.intHasRemainder)(oldState.l2 + 1 | 0)(550);
                        $40.l3 = Neon_Operator._remainder(Neon_Class_HasRemainder.intHasRemainder)(oldState.l3 + 3 | 0)(550);
                        $40.l4 = Neon_Operator._remainder(Neon_Class_HasRemainder.intHasRemainder)(oldState.l4 + 2 | 0)(550);
                        $40.l5 = Neon_Operator._remainder(Neon_Class_HasRemainder.intHasRemainder)(oldState.l5 + 2 | 0)(550);
                        return $40;
                    })());
                };
            };
        };
    };
    var initialState = {
        x: 0,
        y: -50 | 0,
        xBomb: 0,
        tar: false,
        l1: 50,
        l2: 150,
        l3: 100,
        l4: 6,
        l5: 200
    };
    return function __do() {
        var v = PrestoDOM_Core.mkDyn(PrestoDOM_Core.boolDyn)(false)();
        var v1 = PrestoDOM_Core.mkDyn(PrestoDOM_Core.boolDyn)(false)();
        var v2 = PrestoDOM_Core.mkDyn(PrestoDOM_Core.boolDyn)(false)();
        var v3 = PrestoDOM_Util.render(view({
            left: v,
            right: v1,
            boom: v2
        }))(initialState)();
        return Control_Apply.applySecond(Control_Monad_Eff.applyEff)(v3.updateState(Control_Apply.apply(FRP_Behavior.applyABehavior(FRP_Event.functorEvent))(Control_Apply.apply(FRP_Behavior.applyABehavior(FRP_Event.functorEvent))(Control_Apply.apply(FRP_Behavior.applyABehavior(FRP_Event.functorEvent))(Data_Functor.map(FRP_Behavior.functorABehavior(FRP_Event.functorEvent))(movement)(FRP_Behavior_Keyboard.key(37)))(FRP_Behavior_Keyboard.key(39)))(FRP_Behavior_Keyboard.key(32)))(v3.stateBeh))(FRP_Event_Time.animationFrame))(Control_Applicative.pure(Control_Monad_Eff.applicativeEff)(Data_Unit.unit))();
    };
})();
module.exports = {
    main: main,
    loons: loons,
    fire: fire,
    incRoc: incRoc,
    crossPath: crossPath,
    view: view
};
